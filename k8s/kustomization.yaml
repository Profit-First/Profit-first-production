apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Namespace for all resources
namespace: profit-first

# Resources in deployment order
resources:
  # 1. Namespace first
  - namespace.yaml
  
  # 2. Storage (PVCs)
  - redis/redis-pvc.yaml
  
  # 3. ConfigMaps and Secrets
  - backend/backend-configmap.yaml
  - backend/backend-secret.yaml
  - frontend/frontend-configmap.yaml
  
  # 4. Redis (dependency for backend)
  - redis/redis-deployment.yaml
  - redis/redis-service.yaml
  
  # 5. Backend (depends on Redis)
  - backend/backend-deployment.yaml
  - backend/backend-service.yaml
  - backend/backend-hpa.yaml
  
  # 6. Frontend (depends on backend)
  - frontend/frontend-deployment.yaml
  - frontend/frontend-service.yaml
  
  # 7. Ingress (external access)
  - ingress/ingress.yaml
